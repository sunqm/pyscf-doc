<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>pyscf.agf2 package &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css?v=9b431c29" />
    <script src="../_static/documentation_options.js?v=4d935f96"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyscf.ao2mo package" href="pyscf.ao2mo.html" />
    <link rel="prev" title="pyscf.adc package" href="pyscf.adc.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#pyscf_api_docs/pyscf.agf2" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.4</span>
          <span class="md-header-nav__topic"> pyscf.agf2 package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="pyscf.html" class="md-tabs__link">pyscf package</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.4</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install PySCF</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#advanced-build-options" class="md-nav__link">Advanced build options</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#install-pyscf-extensions" class="md-nav__link">Install PySCF extensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#troubleshooting" class="md-nav__link">Troubleshooting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html" class="md-nav__link">API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#subpackages" class="md-nav__link">Subpackages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#submodules" class="md-nav__link">Submodules</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf.post_scf" class="md-nav__link">pyscf.post_scf module</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf" class="md-nav__link">Module contents</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#pyscf-api-docs-pyscf-agf2--page-root" class="md-nav__link">pyscf.agf2 package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.aux_space" class="md-nav__link">pyscf.agf2.aux_space module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.compress" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.compress()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.copy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.copy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.dot" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.dot()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.eig" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.eig()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.get_array()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.get_occupied" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.get_occupied()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.get_virtual" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.get_virtual()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.load" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.load()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.moment" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.moment()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.naux" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.naux</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.nphys" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.nphys</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.real_freq_spectrum" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.real_freq_spectrum()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.remove_uncoupled" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.remove_uncoupled()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.save" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.save()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.AuxiliarySpace.sort" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.sort()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.GreensFunction" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GreensFunction</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.GreensFunction.compress" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GreensFunction.compress()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.GreensFunction.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GreensFunction.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.GreensFunction.real_freq_spectrum" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GreensFunction.real_freq_spectrum()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.SelfEnergy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.SelfEnergy.compress" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.compress()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.SelfEnergy.get_greens_function" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.get_greens_function()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.SelfEnergy.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.SelfEnergy.real_freq_spectrum" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.real_freq_spectrum()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.combine" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">combine()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.compress_via_gf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">compress_via_gf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.compress_via_se" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">compress_via_se()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.aux_space.davidson" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">davidson()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.chempot" class="md-nav__link">pyscf.agf2.chempot module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.chempot.binsearch_chempot" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">binsearch_chempot()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.chempot.minimize_chempot" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">minimize_chempot()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.chkfile" class="md-nav__link">pyscf.agf2.chkfile module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.chkfile.dump_agf2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">dump_agf2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.chkfile.load" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.chkfile.load_agf2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">load_agf2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.chkfile.load_mol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">load_mol()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.dfragf2" class="md-nav__link">pyscf.agf2.dfragf2 module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DF</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DF.prange" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DF.prange()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DFRAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFRAGF2</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DFRAGF2.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DFRAGF2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DFRAGF2.get_jk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.get_jk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DFRAGF2.reset" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.reset()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.DFRAGF2.with_df" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.with_df</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfragf2.get_jk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_jk()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.dfuagf2" class="md-nav__link">pyscf.agf2.dfuagf2 module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.dfuagf2.DFUAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFUAGF2</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.dfuagf2.DFUAGF2.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfuagf2.DFUAGF2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfuagf2.DFUAGF2.get_jk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.get_jk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfuagf2.DFUAGF2.reset" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.reset()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfuagf2.DFUAGF2.with_df" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.with_df</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.dfuagf2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.mpi_helper" class="md-nav__link">pyscf.agf2.mpi_helper module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.allreduce" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">allreduce()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.allreduce_safe_inplace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">allreduce_safe_inplace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.barrier" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">barrier()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.bcast" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">bcast()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.bcast_dict" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">bcast_dict()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.nrange" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">nrange()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.prange" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.mpi_helper.reduce" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.ragf2" class="md-nav__link">pyscf.agf2.ragf2 module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.async_io" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.async_io</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.build_gf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_gf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.build_se" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.density_fit" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.density_fit()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.dump_chk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.dump_chk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.e_corr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.e_corr</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.e_tot" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.e_tot</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.eaagf2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.eaagf2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.energy_1body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_1body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.energy_2body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_2body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.energy_mp2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_mp2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.energy_nuc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_nuc()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.fock_loop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.fock_loop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.get_ea" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_ea()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.get_fock" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_fock()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.get_ip" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_ip()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.get_jk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_jk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.incore_complete" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.incore_complete</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.init_gf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.init_gf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.ipagf2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.ipagf2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.nmo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.nmo</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.nocc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.nocc</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.qmo_coeff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.qmo_coeff</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.qmo_energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.qmo_energy</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.qmo_occ" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.qmo_occ</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.reset" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.reset()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.run_diis" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.run_diis()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.update" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.update()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.update_from_chk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.update_from_chk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.RAGF2.update_from_chk_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.update_from_chk_()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.energy_1body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy_1body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.energy_2body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy_2body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.energy_mp2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy_mp2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.fock_loop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">fock_loop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.get_fock" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_fock()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.get_frozen_mask" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_frozen_mask()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.get_jk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_jk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.ragf2_slow" class="md-nav__link">pyscf.agf2.ragf2_slow module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2_slow.RAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2_slow.RAGF2.build_se" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2_slow.RAGF2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2_slow.RAGF2.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2_slow.RAGF2.run_diis" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2.run_diis()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.ragf2_slow.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.uagf2" class="md-nav__link">pyscf.agf2.uagf2 module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.build_gf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_gf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.build_se" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.density_fit" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.density_fit()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.eaagf2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.eaagf2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.energy_1body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.energy_1body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.energy_2body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.energy_2body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.energy_mp2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.energy_mp2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.fock_loop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.fock_loop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.get_ea" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.get_ea()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.get_fock" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.get_fock()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.get_ip" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.get_ip()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.init_gf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.init_gf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.ipagf2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.ipagf2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.nmo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.nmo</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.nocc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.nocc</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.qmo_coeff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.qmo_coeff</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.qmo_energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.qmo_energy</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.qmo_occ" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.qmo_occ</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.UAGF2.run_diis" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.run_diis()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.energy_1body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy_1body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.energy_2body" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy_2body()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.energy_mp2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy_mp2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.fock_loop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">fock_loop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.get_fock" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_fock()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2.get_frozen_mask" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_frozen_mask()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2.uagf2_slow" class="md-nav__link">pyscf.agf2.uagf2_slow module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2_slow.UAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2_slow.UAGF2.build_se" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2_slow.UAGF2.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se_part()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2_slow.UAGF2.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2_slow.UAGF2.run_diis" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2.run_diis()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.uagf2_slow.build_se_part" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.agf2" class="md-nav__link">Module contents</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#auxiliary-second-order-green-s-function-perturbation-therory" class="md-nav__link">Auxiliary second-order Green’s function perturbation therory</a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.AGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AGF2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.RAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RAGF2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.agf2.UAGF2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UAGF2()</span></code></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/pyscf_api_docs/pyscf.agf2.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="pyscf-agf2-package">
<h1 id="pyscf-api-docs-pyscf-agf2--page-root">pyscf.agf2 package<a class="headerlink" href="#pyscf-api-docs-pyscf-agf2--page-root" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-pyscf.agf2.aux_space">
<span id="pyscf-agf2-aux-space-module"></span><h2 id="module-pyscf.agf2.aux_space">pyscf.agf2.aux_space module<a class="headerlink" href="#module-pyscf.agf2.aux_space" title="Link to this heading">¶</a></h2>
<p>Auxiliary space class and helper functions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">AuxiliarySpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Simple container to hold the energies, couplings and chemical</dt><dd><p>potential associated with an auxiliary space.</p>
</dd>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>energy<span class="classifier">1D array</span></dt><dd><p>Energies of the poles</p>
</dd>
<dt>coupling<span class="classifier">2D array</span></dt><dd><p>Coupling vector of the poles to each physical state</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Chemical potential associated with the energies</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.compress" title="Link to this definition">¶</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.copy" title="Link to this definition">¶</a></dt>
<dd><p>Returns a copy of the current object.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>AuxiliarySpace</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.dot" title="Link to this definition">¶</a></dt>
<dd><p>Returns the dot product of <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="pyscf.agf2.aux_space.AuxiliarySpace.get_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_array()</span></code></a> with a vector.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical (1p + 1h) part of the matrix</p>
</dd>
<dt>vec<span class="classifier">ndarray</span></dt><dd><p>Vector to compute dot product with</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>out<span class="classifier">2D array</span></dt><dd><p>If provided, use to store output</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Scale energies (by default, <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code> is not used
and energies retain their values). Default 0.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray with shape of <code class="xref py py-attr docutils literal notranslate"><span class="pre">vec</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.eig">
<span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.eig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.eig" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Computes the eigenvalues and eigenvectors of the array</dt><dd><p>returned by <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="pyscf.agf2.aux_space.AuxiliarySpace.get_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_array()</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical (1p + 1h) part of the matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>out<span class="classifier">2D array</span></dt><dd><p>If provided, use to store output</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Scale energies (by default, <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code> is not used
and energies retain their values). Default 0.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays (eigenvalues, eigenvectors)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.get_array">
<span class="sig-name descname"><span class="pre">get_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.get_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Expresses the auxiliaries as an array, i.e. the extended</dt><dd><p>Fock matrix in AGF2 or Hamiltonian of ADC(2).</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical (1p + 1h) part of the matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>out<span class="classifier">2D array</span></dt><dd><p>If provided, use to store output</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Scale energies (by default, <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code> is not used
and energies retain their values). Default 0.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Array representing the coupling of the auxiliary space to
the physical space</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.get_occupied">
<span class="sig-name descname"><span class="pre">get_occupied</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.get_occupied"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_occupied" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns a copy of the current AuxiliarySpace object</dt><dd><p>containing only the poles with energy less than the
chemical potential. The object should already be sorted.</p>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> with only the occupied auxiliaries</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.get_virtual">
<span class="sig-name descname"><span class="pre">get_virtual</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.get_virtual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_virtual" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns a copy of the current AuxiliarySpace object</dt><dd><p>containing only the poles with energy greater than the
chemical potential. The object should already be sorted.</p>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> with only the virtual auxiliaries</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.load" title="Link to this definition">¶</a></dt>
<dd><p>Loads the auxiliaries from a chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>Key to be used in h5py object. It can contain “/” to
represent the path in the HDF5 storage structure.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.moment">
<span class="sig-name descname"><span class="pre">moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.moment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.moment" title="Link to this definition">¶</a></dt>
<dd><p>Builds the nth moment of the spectral distribution.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>n<span class="classifier">int or list of int</span></dt><dd><p>Moment(s) to compute</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>squeeze<span class="classifier">bool</span></dt><dd><p>If True, use <code class="xref py py-func docutils literal notranslate"><span class="pre">np.squeeze()</span></code> on output so that in
the case of <code class="xref py py-attr docutils literal notranslate"><span class="pre">n</span></code> being an int, a 2D array is
returned. If False, output is always 3D. Default True.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of moments</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.naux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux</span></span><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.naux" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.nphys">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nphys</span></span><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.nphys" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.real_freq_spectrum">
<span class="sig-name descname"><span class="pre">real_freq_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.real_freq_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.real_freq_spectrum" title="Link to this definition">¶</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.remove_uncoupled">
<span class="sig-name descname"><span class="pre">remove_uncoupled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.remove_uncoupled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.remove_uncoupled" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Removes poles with very low spectral weight (uncoupled</dt><dd><p>to the physical space) in-place.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Threshold for the spectral weight (squared norm)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.save" title="Link to this definition">¶</a></dt>
<dd><p>Saves the auxiliaries in chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>Key to be used in h5py object. It can contain “/” to
represent the path in the HDF5 storage structure.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.sort" title="Link to this definition">¶</a></dt>
<dd><p>Sort in-place via the energies to make slicing easier.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">GreensFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a></p>
<p>Defines a Green’s function represented as a
<a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction.compress" title="Link to this definition">¶</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction.make_rdm1" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns the first-order reduced density matrix associated</dt><dd><p>with the Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>chempot<span class="classifier">float</span></dt><dd><p>If provided, use instead of <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.chempot</span></code></p>
</dd>
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction.real_freq_spectrum">
<span class="sig-name descname"><span class="pre">real_freq_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction.real_freq_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction.real_freq_spectrum" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Express the auxiliaries as a spectral function on the real</dt><dd><p>frequency axis.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>grid<span class="classifier">1D array</span></dt><dd><p>Real frequency grid</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>eta<span class="classifier">float</span></dt><dd><p>Peak broadening factor in Hartrees. Default is 0.02.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of the spectrum, with the first index being the
frequency</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">SelfEnergy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a></p>
<p>Defines a self-energy represented as a <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a>
object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.compress" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compress the auxiliaries via moments of the particle and</dt><dd><p>hole Green’s function and self-energy. Resulting <code class="xref py py-attr docutils literal notranslate"><span class="pre">naux</span></code>
depends on the chosen <code class="xref py py-attr docutils literal notranslate"><span class="pre">n</span></code>.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array or None</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix.
Only required if <code class="xref py py-attr docutils literal notranslate"><span class="pre">n[0]</span></code> is not None.</p>
</dd>
<dt>n<span class="classifier">tuple of int</span></dt><dd><p>Compression level of the Green’s function and
self-energy, respectively.</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Linear dependency tolerance. Default value is 1e-12</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.SelfEnergy" title="pyscf.agf2.aux_space.SelfEnergy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a> with reduced auxiliary dimension.</p>
</dd>
<dt>Raises:</dt><dd><p>MemoryError if the compression according to Green’s
function moments will exceed the maximum allowed memory.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.get_greens_function">
<span class="sig-name descname"><span class="pre">get_greens_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.get_greens_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.get_greens_function" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns a <a class="reference internal" href="#pyscf.agf2.aux_space.GreensFunction" title="pyscf.agf2.aux_space.GreensFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></a> by solving the Dyson</dt><dd><p>equation.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.GreensFunction" title="pyscf.agf2.aux_space.GreensFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.make_rdm1" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns the first-order reduced density matrix associated</dt><dd><p>with the self-energy via the <a class="reference internal" href="#pyscf.agf2.aux_space.GreensFunction" title="pyscf.agf2.aux_space.GreensFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>chempot<span class="classifier">float</span></dt><dd><p>If provided, use instead of <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.chempot</span></code></p>
</dd>
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.real_freq_spectrum">
<span class="sig-name descname"><span class="pre">real_freq_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.real_freq_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.real_freq_spectrum" title="Link to this definition">¶</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.combine">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">auxspcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#combine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.combine" title="Link to this definition">¶</a></dt>
<dd><p>Combine a set of <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> objects. attr:<cite>chempot</cite>
is inherited from the first element.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.compress_via_gf">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">compress_via_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#compress_via_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.compress_via_gf" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compress the auxiliaries of the separate occupied and</dt><dd><p>virtual parts of the self-energy according to consistency
in the moments of the Green’s function</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>n<span class="classifier">int</span></dt><dd><p>Truncation parameter, conserves the separate particle
and hole moments to order 2*n+1.</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Linear dependency tolerance. Default value is 1e-12</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.SelfEnergy" title="pyscf.agf2.aux_space.SelfEnergy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a> with reduced auxiliary dimension</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.compress_via_se">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">compress_via_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#compress_via_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.compress_via_se" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compress the auxiliaries of the separate occupied and</dt><dd><p>virtual parts of the self-energy according to consistency
in its moments.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>n<span class="classifier">int</span></dt><dd><p>Truncation parameter, conserves the separate particle
and hole moments to order 2*n+1.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.SelfEnergy" title="pyscf.agf2.aux_space.SelfEnergy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a> with reduced auxiliary dimension</p>
</dd>
<dt>Ref:</dt><dd><dl class="simple">
<dt>[1] H. Muther, T. Taigel and T.T.S. Kuo, Nucl. Phys., 482,</dt><dd><p>1988, pp. 601-616.</p>
</dd>
<dt>[2] D. Van Neck,  K. Piers and M. Waroquier, J. Chem. Phys.,</dt><dd><p>115, 2001, pp. 15-25.</p>
</dd>
<dt>[3] H. Muther and L.D. Skouras, Nucl. Phys., 55, 1993,</dt><dd><p>pp. 541-562.</p>
</dd>
<dt>[4] Y. Dewulf, D. Van Neck, L. Van Daele and M. Waroquier,</dt><dd><p>Phys. Lett. B, 396, 1997, pp. 7-14.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.davidson">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">davidson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxspc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntrial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#davidson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.davidson" title="Link to this definition">¶</a></dt>
<dd><dl>
<dt>Diagonalise the result of <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="pyscf.agf2.aux_space.AuxiliarySpace.get_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">AuxiliarySpace.get_array()</span></code></a> using</dt><dd><p>the sparse <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.dot" title="pyscf.agf2.aux_space.AuxiliarySpace.dot"><code class="xref py py-func docutils literal notranslate"><span class="pre">AuxiliarySpace.dot()</span></code></a> method, with the Davidson
algorithm.</p>
<p>This algorithm may perform poorly for IPs or EAs if they are
not extremal eigenvalues, which they are not in standard AGF2.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>auxspc<span class="classifier">AuxiliarySpace or subclass</span></dt><dd><p>Auxiliary space object to solve for</p>
</dd>
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>chempot<span class="classifier">float</span></dt><dd><p>If provided, use instead of <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.chempot</span></code></p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of roots to solve for. Default 1.</p>
</dd>
<dt>which<span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Which eigenvalues to solve for. Options are:</dt><dd><p><cite>LM</cite> : Largest (in magnitude) eigenvalues.
<cite>SM</cite> : Smallest (in magnitude) eigenvalues.
<cite>LA</cite> : Largest (algebraic) eigenvalues.
<cite>SA</cite> : Smallest (algebraic) eigenvalues.</p>
</dd>
</dl>
<p>Default ‘SM’.</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence threshold</p>
</dd>
<dt>maxiter<span class="classifier">int</span></dt><dd><p>Maximum number of iterations. Default 10*dim</p>
</dd>
<dt>ntrial<span class="classifier">int</span></dt><dd><p>Maximum number of trial vectors. Default
min(dim, max(2*nroots+1, 20))</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays (eigenvalues, eigenvectors)</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.agf2.chempot">
<span id="pyscf-agf2-chempot-module"></span><h2 id="module-pyscf.agf2.chempot">pyscf.agf2.chempot module<a class="headerlink" href="#module-pyscf.agf2.chempot" title="Link to this heading">¶</a></h2>
<p>Functions for tuning the chemical potential.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chempot.binsearch_chempot">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chempot.</span></span><span class="sig-name descname"><span class="pre">binsearch_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chempot.html#binsearch_chempot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chempot.binsearch_chempot" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Finds a chemical potential which best agrees with the number</dt><dd><p>of physical electrons and abides by the Aufbau principal via
a binary search.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>fock<span class="classifier">2D array or tuple of arrays</span></dt><dd><p>Fock matrix to diagonalise, may be the physical Fock matrix
or extended Fock matrix. Can also be the output of
<code class="xref py py-func docutils literal notranslate"><span class="pre">np.linalg.eigh()</span></code> for this matrix, i.e. a tuple of the
eigenvalues and eigenvectors.</p>
</dd>
<dt>nphys<span class="classifier">int</span></dt><dd><p>Number of physical degrees of freedom</p>
</dd>
<dt>nelec<span class="classifier">int</span></dt><dd><p>Number of physical electrons</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF.
Default 2.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>chemical potential, and the error in the number of electrons</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chempot.minimize_chempot">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chempot.</span></span><span class="sig-name descname"><span class="pre">minimize_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chempot.html#minimize_chempot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chempot.minimize_chempot" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Finds a set of auxiliary energies and chemical potential on</dt><dd><p>the physical space which best satisfy the number of electrons.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">AuxiliarySpace</span></dt><dd><p>Auxiliary space</p>
</dd>
<dt>fock<span class="classifier">2D array</span></dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>nelec<span class="classifier">int</span></dt><dd><p>Number of physical electrons</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF.
Default 2.</p>
</dd>
<dt>x0<span class="classifier">float</span></dt><dd><p>Initial guess for <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code>. Default 0.0</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence threshold (units are the same as <code class="xref py py-attr docutils literal notranslate"><span class="pre">nelec</span></code>).
Default 1e-6.</p>
</dd>
<dt>maxiter<span class="classifier">int</span></dt><dd><p>Maximum number of iterations. Default 200.</p>
</dd>
<dt>jac<span class="classifier">bool</span></dt><dd><p>If True, use gradient. Default True.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>AuxiliarySpace object with altered <code class="xref py py-attr docutils literal notranslate"><span class="pre">energy</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code>, and the SciPy <code class="xref py py-attr docutils literal notranslate"><span class="pre">OptimizeResult</span></code> object.</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.agf2.chkfile">
<span id="pyscf-agf2-chkfile-module"></span><h2 id="module-pyscf.agf2.chkfile">pyscf.agf2.chkfile module<a class="headerlink" href="#module-pyscf.agf2.chkfile" title="Link to this heading">¶</a></h2>
<p>Functions to support chkfiles with MPI</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.dump_agf2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">dump_agf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#dump_agf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.dump_agf2" title="Link to this definition">¶</a></dt>
<dd><p>Save the AGF2 calculatuion to a chkfile.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.load">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.load" title="Link to this definition">¶</a></dt>
<dd><p>Load array(s) from chkfile.</p>
<p>See pyscf.lib.chkfile</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.load_agf2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">load_agf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#load_agf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.load_agf2" title="Link to this definition">¶</a></dt>
<dd><p>Load the AGF2 data from the chkfile.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.load_mol">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">load_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#load_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.load_mol" title="Link to this definition">¶</a></dt>
<dd><p>Load the mol from the chkfile.</p>
<p>See pyscf.lib.chkfile</p>
</dd></dl>
</section>
<section id="module-pyscf.agf2.dfragf2">
<span id="pyscf-agf2-dfragf2-module"></span><h2 id="module-pyscf.agf2.dfragf2">pyscf.agf2.dfragf2 module<a class="headerlink" href="#module-pyscf.agf2.dfragf2" title="Link to this heading">¶</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory
with density fitting</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">DF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DF" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.df.html#pyscf.df.df.DF" title="pyscf.df.df.DF"><code class="xref py py-class docutils literal notranslate"><span class="pre">DF</span></code></a></p>
<p>Replaces the <a class="reference internal" href="#pyscf.agf2.dfragf2.DF.prange" title="pyscf.agf2.dfragf2.DF.prange"><code class="xref py py-class docutils literal notranslate"><span class="pre">DF.prange</span></code></a> function with one which
natively supports MPI, if used.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DF.prange">
<span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DF.prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DF.prange" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">DFRAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DFRAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2" title="pyscf.agf2.ragf2.RAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RAGF2</span></code></a></p>
<p>Restricted AGF2 with canonical HF reference with density fitting</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>allow_lowmem_build<span class="classifier">bool or str</span></dt><dd><p>Allow the self-energy build to switch to a serially slower
code with lower thread-private memory overhead if needed. One
of True, False or ‘force’. Default value is True.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DFRAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.ao2mo" title="Link to this definition">¶</a></dt>
<dd><p>Get the density-fitted electronic repulsion integrals in
MO basis.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.get_jk" title="Link to this definition">¶</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs). In
the case of no bra/ket symmetry, a tuple can be passed.</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DFRAGF2.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.with_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_df</span></span><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.with_df" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.get_jk">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#get_jk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.get_jk" title="Link to this definition">¶</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs). In
the case of no bra/ket symmetry, a tuple can be passed.</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.agf2.dfuagf2">
<span id="pyscf-agf2-dfuagf2-module"></span><h2 id="module-pyscf.agf2.dfuagf2">pyscf.agf2.dfuagf2 module<a class="headerlink" href="#module-pyscf.agf2.dfuagf2" title="Link to this heading">¶</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
unrestricted references with density fitting</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfuagf2.</span></span><span class="sig-name descname"><span class="pre">DFUAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#DFUAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.uagf2.UAGF2" title="pyscf.agf2.uagf2.UAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">UAGF2</span></code></a></p>
<p>Unrestricted AGF2 with canonical HF reference with density fitting</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>allow_lowmem_build<span class="classifier">bool</span></dt><dd><p>Allow the self-energy build to switch to a serially slower
code with lower thread-private memory overhead if needed. One
of True, False or ‘force’. Default value is True.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#DFUAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.ao2mo" title="Link to this definition">¶</a></dt>
<dd><p>Get the density-fitted electronic repulsion integrals in
MO basis.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.get_jk" title="Link to this definition">¶</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs). In
the case of no bra/ket symmetry, a tuple can be passed.</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#DFUAGF2.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.with_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_df</span></span><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.with_df" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfuagf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.agf2.mpi_helper">
<span id="pyscf-agf2-mpi-helper-module"></span><h2 id="module-pyscf.agf2.mpi_helper">pyscf.agf2.mpi_helper module<a class="headerlink" href="#module-pyscf.agf2.mpi_helper" title="Link to this heading">¶</a></h2>
<p>MPI helper functions using mpi4py</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.allreduce">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">allreduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sendbuf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#allreduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.allreduce" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.allreduce_safe_inplace">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">allreduce_safe_inplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#allreduce_safe_inplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.allreduce_safe_inplace" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.barrier">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">barrier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#barrier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.barrier" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.bcast">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">bcast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#bcast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.bcast" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.bcast_dict">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">bcast_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#bcast_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.bcast_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.nrange">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">nrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#nrange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.nrange" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.prange" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-func docutils literal notranslate"><span class="pre">lib.prange()</span></code> distributed over MPI processes. Returns
the range for a single MPI rank.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.reduce">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sendbuf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.reduce" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.agf2.ragf2">
<span id="pyscf-agf2-ragf2-module"></span><h2 id="module-pyscf.agf2.ragf2">pyscf.agf2.ragf2 module<a class="headerlink" href="#module-pyscf.agf2.ragf2" title="Link to this heading">¶</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">RAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a></p>
<p>Restricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2.e_tot" title="pyscf.agf2.ragf2.RAGF2.e_tot"><code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></a></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2.e_tot" title="pyscf.agf2.ragf2.RAGF2.e_tot"><code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></a></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.ao2mo" title="Link to this definition">¶</a></dt>
<dd><p>Get the electronic repulsion integrals in MO basis.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.async_io">
<span class="sig-name descname"><span class="pre">async_io</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.async_io" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.build_gf">
<span class="sig-name descname"><span class="pre">build_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.build_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.build_gf" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds the auxiliaries of the Green’s function by solving</dt><dd><p>the Dyson equation.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.build_se" title="Link to this definition">¶</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.density_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.density_fit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.dump_chk">
<span class="sig-name descname"><span class="pre">dump_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.dump_chk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.dump_chk" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.dump_flags" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.e_corr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_corr</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.e_corr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.e_tot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.eaagf2">
<span class="sig-name descname"><span class="pre">eaagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.eaagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.eaagf2" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Find the (N+1)-electron charged excitations, corresponding</dt><dd><p>to the smallest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the virtual
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><p>See ipagf2()</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_1body">
<span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_1body" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the one-body energy according to the RHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of Green’s function</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_2body">
<span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_2body" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_mp2">
<span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_mp2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_nuc">
<span class="sig-name descname"><span class="pre">energy_nuc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.energy_nuc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_nuc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.fock_loop">
<span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.fock_loop" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_ea">
<span class="sig-name descname"><span class="pre">get_ea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.get_ea"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_ea" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_fock" title="Link to this definition">¶</a></dt>
<dd><p>Computes the physical space Fock matrix in MO basis.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_ip">
<span class="sig-name descname"><span class="pre">get_ip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.get_ip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_ip" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_jk" title="Link to this definition">¶</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs)</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.incore_complete">
<span class="sig-name descname"><span class="pre">incore_complete</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.incore_complete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.init_gf">
<span class="sig-name descname"><span class="pre">init_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.init_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.init_gf" title="Link to this definition">¶</a></dt>
<dd><p>Builds the Hartree-Fock Green’s function.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.ipagf2">
<span class="sig-name descname"><span class="pre">ipagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.ipagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.ipagf2" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Find the (N-1)-electron charged excitations, corresponding</dt><dd><p>to the largest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the occupied
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of roots (poles) requested. Default 1.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>IP and transition moment (float, 1D array) if <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code>
= 1, or array of IPs and moments (1D array, 2D array) if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.kernel" title="Link to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.make_rdm1" title="Link to this definition">¶</a></dt>
<dd><p>Computes the one-body reduced density matrix in MO basis.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of density matrix</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.nmo" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.nocc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.qmo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_coeff</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.qmo_coeff" title="Link to this definition">¶</a></dt>
<dd><p>Gives the couplings in AO basis</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.qmo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_energy</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.qmo_energy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.qmo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_occ</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.qmo_occ" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.run_diis" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.update" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.update_from_chk">
<span class="sig-name descname"><span class="pre">update_from_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.update_from_chk" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.update_from_chk_">
<span class="sig-name descname"><span class="pre">update_from_chk_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.update_from_chk_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.update_from_chk_" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.energy_1body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#energy_1body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.energy_1body" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the one-body energy according to the RHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of Green’s function</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.energy_2body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#energy_2body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.energy_2body" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.energy_mp2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.energy_mp2" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula for an MP2 self-energy. Per the
definition of one- and two-body partitioning in the Dyson
equation, this result is half of <a class="reference internal" href="#pyscf.agf2.ragf2.energy_2body" title="pyscf.agf2.ragf2.energy_2body"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy_2body()</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>MP2 energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.fock_loop">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#fock_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.fock_loop" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.get_fock">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.get_fock" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Computes the physical space Fock matrix in MO basis. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">rdm1</span></code></dt><dd><p>is not supplied, it is built from <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf</span></code>, which defaults to
the mean-field Green’s function.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">Greensfunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of physical space Fock matrix</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.get_frozen_mask">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">get_frozen_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#get_frozen_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.get_frozen_mask" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.get_jk">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#get_jk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.get_jk" title="Link to this definition">¶</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs)</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.kernel" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.agf2.ragf2_slow">
<span id="pyscf-agf2-ragf2-slow-module"></span><h2 id="module-pyscf.agf2.ragf2_slow">pyscf.agf2.ragf2_slow module<a class="headerlink" href="#module-pyscf.agf2.ragf2_slow" title="Link to this heading">¶</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
arbitrary moment consistency</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2_slow.</span></span><span class="sig-name descname"><span class="pre">RAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2" title="pyscf.agf2.ragf2.RAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RAGF2</span></code></a></p>
<dl class="simple">
<dt>Restricted AGF2 with canonical HF reference for arbitrary</dt><dd><p>moment consistency</p>
</dd>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>nmom<span class="classifier">tuple of int</span></dt><dd><p>Compression level of the Green’s function and
self-energy, respectively</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.build_se" title="Link to this definition">¶</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.dump_flags" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.run_diis" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2_slow.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.agf2.uagf2">
<span id="pyscf-agf2-uagf2-module"></span><h2 id="module-pyscf.agf2.uagf2">pyscf.agf2.uagf2 module<a class="headerlink" href="#module-pyscf.agf2.uagf2" title="Link to this heading">¶</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
unrestricted references</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">UAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2" title="pyscf.agf2.ragf2.RAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RAGF2</span></code></a></p>
<p>Unrestricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.ao2mo" title="Link to this definition">¶</a></dt>
<dd><p>Get the electronic repulsion integrals in MO basis.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.build_gf">
<span class="sig-name descname"><span class="pre">build_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.build_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.build_gf" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds the auxiliaries of the Green’s functions by solving</dt><dd><p>the Dyson equation for each spin.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.build_se" title="Link to this definition">¶</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.density_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.density_fit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.eaagf2">
<span class="sig-name descname"><span class="pre">eaagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.eaagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.eaagf2" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Find the (N+1)-electron charged excitations, corresponding</dt><dd><p>to the smallest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the virtual
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><p>See ipagf2()</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.energy_1body">
<span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.energy_1body" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the one-body energy according to the UHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.energy_2body">
<span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.energy_2body" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.energy_mp2">
<span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.energy_mp2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.fock_loop">
<span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.fock_loop" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.get_ea">
<span class="sig-name descname"><span class="pre">get_ea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.get_ea"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.get_ea" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.get_fock" title="Link to this definition">¶</a></dt>
<dd><p>Computes the physical space Fock matrix in MO basis.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.get_ip">
<span class="sig-name descname"><span class="pre">get_ip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.get_ip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.get_ip" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.init_gf">
<span class="sig-name descname"><span class="pre">init_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.init_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.init_gf" title="Link to this definition">¶</a></dt>
<dd><p>Builds the Hartree-Fock Green’s function.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code>, tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.ipagf2">
<span class="sig-name descname"><span class="pre">ipagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.ipagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.ipagf2" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Find the (N-1)-electron charged excitations, corresponding</dt><dd><p>to the largest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the occupied
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of roots (poles) requested. Default 1.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>IP and transition moment (float, 1D array) if <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code>
= 1, or array of IPs and moments (1D array, 2D array) if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.make_rdm1" title="Link to this definition">¶</a></dt>
<dd><p>Compute the one-body reduced density matrix in MO basis.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s functions for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarray of density matrices</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.nmo" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.nocc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.qmo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_coeff</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.qmo_coeff" title="Link to this definition">¶</a></dt>
<dd><p>Gives the couplings in AO basis</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.qmo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_energy</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.qmo_energy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.qmo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_occ</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.qmo_occ" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.run_diis" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.energy_1body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#energy_1body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.energy_1body" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the one-body energy according to the UHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.energy_2body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#energy_2body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.energy_2body" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.energy_mp2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.energy_mp2" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula for an MP2 self-energy. Per the
definition of one- and two-body partitioning in the Dyson
equation, this result is half of <a class="reference internal" href="#pyscf.agf2.uagf2.energy_2body" title="pyscf.agf2.uagf2.energy_2body"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy_2body()</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>MP2 energy</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.fock_loop">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#fock_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.fock_loop" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.get_fock">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.get_fock" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Computes the physical space Fock matrix in MO basis. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">rdm1</span></code></dt><dd><p>is not supplied, it is built from <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf</span></code>, which defaults to
the mean-field Green’s function.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of physical space Fock matrix</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.get_frozen_mask">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">get_frozen_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#get_frozen_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.get_frozen_mask" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.agf2.uagf2_slow">
<span id="pyscf-agf2-uagf2-slow-module"></span><h2 id="module-pyscf.agf2.uagf2_slow">pyscf.agf2.uagf2_slow module<a class="headerlink" href="#module-pyscf.agf2.uagf2_slow" title="Link to this heading">¶</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
unrestricted references for arbitrary moment consistency</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2_slow.</span></span><span class="sig-name descname"><span class="pre">UAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.uagf2.UAGF2" title="pyscf.agf2.uagf2.UAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">UAGF2</span></code></a></p>
<dl class="simple">
<dt>Unrestricted AGF2 with canonical HF reference for arbitrary</dt><dd><p>moment consistency</p>
</dd>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>nmom<span class="classifier">tuple of int</span></dt><dd><p>Compression level of the Green’s function and
self-energy, respectively</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.build_se" title="Link to this definition">¶</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.dump_flags" title="Link to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.run_diis" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2_slow.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.build_se_part" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.agf2">
<span id="module-contents"></span><h2 id="module-pyscf.agf2">Module contents<a class="headerlink" href="#module-pyscf.agf2" title="Link to this heading">¶</a></h2>
<section id="auxiliary-second-order-green-s-function-perturbation-therory">
<h3 id="auxiliary-second-order-green-s-function-perturbation-therory">Auxiliary second-order Green’s function perturbation therory<a class="headerlink" href="#auxiliary-second-order-green-s-function-perturbation-therory" title="Link to this heading">¶</a></h3>
<p>The AGF2 method permits the computation of quasiparticle excitations and 
ground-state properties at the AGF2(None,0) level.</p>
<p>When using results of this code for publications, please cite the follow papers:
“Wave function perspective and efficient truncation of renormalized second-order perturbation theory”, O. J. Backhouse, M. Nusspickel and G. H. Booth, J. Chem. Theory Comput., 16, 1090 (2020).
“Efficient excitations and spectra within a perturbative renormalization approach”, O. J. Backhouse and G. H. Booth, J. Chem. Theory Comput., 16, 6294 (2020).</p>
<p>Simple usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">agf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; H 0 0 1'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gf2</span> <span class="o">=</span> <span class="n">agf2</span><span class="o">.</span><span class="n">AGF2</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gf2</span><span class="o">.</span><span class="n">ipagf2</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">agf2.AGF2()</span></code> returns an instance of AGF2 class.  Valid parameters to
control the AGF2 method are:</p>
<blockquote>
<div><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-6.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default 
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default 
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>diis_min_space<span class="classifier"></span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
</dl>
</div></blockquote>
<p>Saved result</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.AGF2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.</span></span><span class="sig-name descname"><span class="pre">AGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2.html#AGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.AGF2" title="Link to this definition">¶</a></dt>
<dd><p>Restricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.RAGF2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.</span></span><span class="sig-name descname"><span class="pre">RAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2.html#RAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.RAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Restricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.UAGF2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.</span></span><span class="sig-name descname"><span class="pre">UAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2.html#UAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.UAGF2" title="Link to this definition">¶</a></dt>
<dd><p>Unrestricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pyscf.adc.html" title="pyscf.adc package"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> pyscf.adc package </span>
              </div>
            </a>
          
          
            <a href="pyscf.ao2mo.html" title="pyscf.ao2mo package"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> pyscf.ao2mo package </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>